# MySQL 事务基础

## 基本概念

- 一个操作序列，这些操作要么都执行，要么都不执行
- 它是一个不可分割的工作单位。



### 事务四大特性(简称ACID)

- 原子性(Atomicity)
- 一致性(Consistency)
- 隔离性(Isolation)
- 持久性(Durability)



原子性（atomicity）

- 一个事务必须被视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性

一致性（consistency）

- 数据库总是从一个一致性的状态转换到另一个一致性的状态。

隔离性（isolation）

- 通常来说，一个事务所做的修改在最终提交以前，对其他事务是不可见的。

持久性（durability）

- 一旦事务提交，则其所做的修改会永久保存到数据库。（此时即使系统崩溃，修改的数据也不会丢失。）



## 事务命令

### 确认表引擎

确认表引擎类型必须是`innodb`类型才可以使用事务。

```sql
-- 查看表引擎
show create table tb_name;
```

### 开启事务

```sql
begin;
-- 或者
start transaction;
```

- 开启事务后执行修改命令，变更会维护到本地缓存中，而不维护到物理表中

### 提交事务

```sql
commit;
```

### 回滚事务

```sql
rollback;
```

- 放弃缓存中变更的数据



## 自动事务事件

1. 修改数据的命令会自动的触发事务，包括insert、update、delete。
2. 手动开启事务可以进行多次数据的修改，如果成功一起成功，否则一起会滚到之前的数据。